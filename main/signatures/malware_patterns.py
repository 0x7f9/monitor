malware_patterns = [
    r"powershell\s+-e",                                      # Detects PowerShell -e encoded command
    r"iex\s*\(",                                             # Detects PowerShell Invoke-Expression iex()
    r"exec\s*\(",                                            # Detects Python's exec() function
    r"wget\s+",                                              # Detects wget (common for downloading payloads)
    r"curl\s+",                                              # Detects curl (common for downloading payloads)
    r"invoke-expression\s+",                                 # Detects PowerShell Invoke-Expression
    r"webclient\s*\.\s*downloadfile\s*\(",                   # Detects WebClient.DownloadFile in C#
    r"httprequest\s*\.\s*open\s*\(",                         # Detects HTTP requests in JavaScript
    r"fetch\s*\(",                                           # Detects the Fetch API in JavaScript
    r"http\s*\.",                                            # Detects HTTP methods and APIs
    r"New-Object\s+",                                        # Detects New-Object spawning
    r"Start-Process\s+-FilePath",                            # Detects Start-Process cmdlet (used to invoke powershell scripts)
    r"Invoke-WebRequest",                                    # Detects Invoke-WebRequest cmdlet
    r"Invoke-Mimikatz",                                      # Detects Invoke-Mimikatz cmdlet (common for credential dumping)
    r"Invoke-Obfuscation",                                   # Detects Invoke-Obfuscation tool (common for obfuscating malicious PowerShell scripts)
    r"Invoke-Shellcode",                                     # Detects Invoke-Shellcode cmdlet (common for code execution)
    r"advfirewall\s*",                                       # Detects scripts trying to make changes to the firewall profiles
    r"windowstyle\s*",                                       # Detects scripts using hidden flags 
    r"@echo off",                                            # Detects all hidden running scripts 
    r"@CreateShortcut\s*",                                   # Detects file saving to disk in batch files 


    # add more patterns to detect here
]